<div class="playlist-container">
  <h2>Playlist Viewer</h2>
  
  <div class="controls">
    <div class="form-group">
      <label>Select Screen:</label>
      <select [(ngModel)]="selectedScreenId" name="screen">
        <option *ngFor="let screen of screens" [value]="screen.id">
          {{ screen.name }} - {{ screen.location }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label>Date & Time:</label>
      <input 
        type="datetime-local" 
        [(ngModel)]="selectedDateTime" 
        name="datetime">
    </div>

    <button class="btn-primary" (click)="loadPlaylist()" [disabled]="loading">
      {{ loading ? 'Loading...' : 'Load Playlist' }}
    </button>
  </div>

  <div class="playlist-info" *ngIf="playlist.length > 0">
    <h3>Playlist for Selected Time</h3>
    <p>Total Duration: {{ getTotalDuration() }}</p>
  </div>

  <div class="playlist-items">
    <div *ngFor="let item of playlist" class="playlist-item">
      <div class="item-number">{{ item.playOrder }}</div>
      <div class="item-preview">
        <!-- FIXED: Remove ?. before startsWith -->
        <img *ngIf="item.mediaType && item.mediaType.startsWith('image')" 
             [src]="item.mediaUrl" 
             [alt]="item.title">
        <video *ngIf="item.mediaType && item.mediaType.startsWith('video')" 
               [src]="item.mediaUrl">
        </video>
      </div>
      <div class="item-details">
        <h4>{{ item.title }}</h4>
        <p>Duration: {{ formatDuration(item.durationSeconds) }}</p>
        <p>Type: {{ item.mediaType }}</p>
        <p>Play Order: {{ item.playOrder }}</p>
      </div>
    </div>
  </div>

  <div *ngIf="playlist.length === 0 && !loading" class="no-playlist">
    <p>No active campaign for this screen at the selected time.</p>
  </div>
</div>